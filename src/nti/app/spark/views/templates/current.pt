<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:metal="http://xml.zope.org/namespaces/metal"
	  xmlns:tal="http://xml.zope.org/namespaces/tal">
	<head metal:use-macro="macro:mathplacement_head">
		<metal:slot fill-slot="title">
			<title>Hive Tables</title>
		</metal:slot>
	</head>
	<body>
		<div class="container" tal:define="table options/table">
			<form class="form-horizontal" action="" method="" id="file_form">
			</form>
			<table tal:condition="python: len(table.context)" tal:replace="structure table/render" />

			<div tal:condition="python: not len(table.context)">
				<b>There are no results to show.</b>
			</div>

			<div class="batches" tal:define="table options/table" 
								 tal:condition="python: len(table.context) > table.batchSize">
					Pages: <span tal:replace="structure options/table/renderBatch" />
			</div>
		</div>
		
		<!-- Archive Modal -->
		<div class="modal fade" id="archiveModal" role="dialog">
			<div class="modal-dialog">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Are you sure you want to archive this table?</h4>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-danger" action_url="" id="confirm_archive_button">Confirm</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Reset Modal -->
		<div class="modal fade" id="resetModal" role="dialog">
			<div class="modal-dialog">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Are you sure you want to reset this table?</h4>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-danger" action_url="" id="confirm_reset_button">Confirm</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
					</div>
				</div>
			</div>
		</div>
		
		<script type="text/javascript">
			$(function () {
				$(".archiveButton").click(function () {
					$("#confirm_archive_button").attr('action_url', $(this).attr('action_url'))
				})
			});
			
			$(function () {
				$(".resetButton").click(function () {
					$("#confirm_reset_button").attr('action_url', $(this).attr('action_url'))
				})
			});

			$(document).on("click", "#confirm_archive_button", function(event) {
				url = $(this).attr('action_url')
				$.ajax({
					url: url,
					method: 'POST',
					data: {},
					success: function(result){
						$("#archiveModal").modal('hide');
					},
					error: function(jqXHR, exception){
						alert("An error occurred!")
					}
				});
			});
			
			$(document).on("click", "#confirm_reset_button", function(event) {
				url = $(this).attr('action_url')
				$.ajax({
					url: url,
					method: 'POST',
					data: {},
					success: function(result){
						$("#resetModal").modal('hide');
						location.reload(true);
					},
					error: function(jqXHR, exception){
						alert("An error occurred!")
					}
				});
			});
		</script>

	</body>
</html>
